<!DOCTYPE HTML>
<html lang="en" >
    <head><meta charset="UTF-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"><title>BDD - Mastermind : View preparation · Guillem Efege</title><meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="description" content="Guillem Fernandez's professional web site From Developer for Developers. About Soft Skills and Hard Skills
"><meta name="generator" content="Jekyll (using style of GitBook 3.2.3)"><meta name="author" content="Guillem Efegé"><link rel="stylesheet" href="/assets/gitbook/style.css">
<link rel="stylesheet" href="/assets/gitbook/gitbook-plugin-back-to-top-button/plugin.css">
<link rel="stylesheet" href="/assets/gitbook/gitbook-plugin-expandable-chapters-small2/expandable-chapters-small.css">
<link rel="stylesheet" href="/assets/gitbook/gitbook-plugin-fontsettings/website.css">
<link rel="stylesheet" href="/assets/gitbook/gitbook-plugin-search-pro/search.css">
<link rel="stylesheet" href="/assets/gitbook/gitbook-plugin-splitter/splitter.css">

<link rel="stylesheet" href="/assets/gitbook/rouge/colorful.css">

<link rel="stylesheet" href="/assets/gitbook/custom.css">
<link rel="stylesheet" href="/assets/gitbook/custom-local.css">

<meta name="HandheldFriendly" content="true"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/assets/gitbook/images/apple-touch-icon-precomposed-152.png">
<link rel="shortcut icon" href="//assets/gitbook/images/favicon.ico" type="image/x-icon">
<script src="https://kit.fontawesome.com/172072993d.js" crossorigin="anonymous"></script>




            <link rel="prev" href="/development/bdd/tdd/2014-10-21-bdd-mastermind-view-preparation-to-make-the-ui-testable.html" />
        

        
            <link rel="next" href="/development/bdd/tdd/2014-11-20-bdd-mastermind-adding-calabash-and-creating-our-first-tests.html" />
        
    </head>
    <body>
        <div class="book"><div class="book-summary">
    <script type="text/javascript">
        // Fixes the page links scroll problem on both desktop and mobile browsers
        function pageScrollToTop(element) {
            // both mobile and non-mobile
            $('div.body-inner').animate({scrollTop: 0});
            $(element).parent().find('li>ul>li').removeClass('active');
            return true;  // propagate
        }
        // Fixes the anchor links scroll problem on mobile browsers
        function mobilePageScrollToAnchor(element) {
            $(element).closest('li.chapter').find('ul>li').removeClass('active');
            $(element).parent().addClass('active');
            if ($(document).width() <= 1240) {
                $('div.body-inner').animate({scrollTop: $($(element).attr('href')).get(0).offsetTop});
            }
            return true;
        }
    </script>

    <nav role="navigation">
        <div id="book-search-input" role="search">
            <input type="text" placeholder="Type to search" />
        </div>
        <div id="book-search-input-link" role="search">
            <a href="/assets/search.html">Click to Search</a>
        </div>
        <ul class="summary">
            
            <li class="chapter" data-level="1.1" data-path="">
            
                <a href="/" onclick="pageScrollToTop(this)">
                    Guillem Efege
                </a>
            </li>

            <li class="divider"></li>

            
                <!-- <p>pages</p> -->
                
                    

                    
                        
                        <li class="chapter" data-level="1.1" data-path="/pages/2022-02-04-cv.html">
                        
                            <a href="/pages/2022-02-04-cv.html" onclick="pageScrollToTop(this)">
                                CV Guillem Fernandez
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/pages/2022-02-05-contact.html">
                        
                            <a href="/pages/2022-02-05-contact.html" onclick="pageScrollToTop(this)">
                                Contact me
                            </a>
                            
                                
                            
                        </li>
                    

                    
                        <li class="divider"></li>
                    
                
            
                <!-- <p>posts</p> -->
                
                    

                    
                        
                        <li class="chapter" data-level="1.1" data-path="/opinion/2024-06-10-time-to-reflect.html">
                        
                            <a href="/opinion/2024-06-10-time-to-reflect.html" onclick="pageScrollToTop(this)">
                                Time to reflect
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/opinion/2016-09-18-what-is-the-tatus-of-bdd-in-swift.html">
                        
                            <a href="/opinion/2016-09-18-what-is-the-tatus-of-bdd-in-swift.html" onclick="pageScrollToTop(this)">
                                What Is the Status of BDD in Swift
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/opinion/2016-09-16-and-now-what.html">
                        
                            <a href="/opinion/2016-09-16-and-now-what.html" onclick="pageScrollToTop(this)">
                                And Now What?
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/development/tips'n'tricks/2015-01-23-mfmailcomposeviewcontroller-nightmare.html">
                        
                            <a href="/development/tips'n'tricks/2015-01-23-mfmailcomposeviewcontroller-nightmare.html" onclick="pageScrollToTop(this)">
                                MFMailComposeViewController Nightmare
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/development/tips'n'tricks/2015-01-20-ios-7-and-ios-8-living-together.html">
                        
                            <a href="/development/tips'n'tricks/2015-01-20-ios-7-and-ios-8-living-together.html" onclick="pageScrollToTop(this)">
                                iOS 7 and iOS 8 living together
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/development/bdd/tdd/2014-11-20-bdd-mastermind-adding-calabash-and-creating-our-first-tests.html">
                        
                            <a href="/development/bdd/tdd/2014-11-20-bdd-mastermind-adding-calabash-and-creating-our-first-tests.html" onclick="pageScrollToTop(this)">
                                BDD - Mastermind : Adding calabash and creating our first tests
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter active" data-level="1.2" data-path="/development/bdd/tdd/2014-11-10-bdd-mastermind-view-preparation.html">
                        
                            <a href="/development/bdd/tdd/2014-11-10-bdd-mastermind-view-preparation.html" onclick="pageScrollToTop(this)">
                                BDD - Mastermind : View preparation
                            </a>
                            
                                
                                    <ul><li><a href="#the-result-cells" onclick="mobilePageScrollToAnchor(this)" >The result cells</a></li><li><a href="#test-and-implementation" onclick="mobilePageScrollToAnchor(this)" >Test and implementation</a></li><li><a href="#the-final-method-for-testing-the-visual-result" onclick="mobilePageScrollToAnchor(this)" >The final method for testing the visual result</a></li></ul>

                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/development/bdd/tdd/2014-10-21-bdd-mastermind-view-preparation-to-make-the-ui-testable.html">
                        
                            <a href="/development/bdd/tdd/2014-10-21-bdd-mastermind-view-preparation-to-make-the-ui-testable.html" onclick="pageScrollToTop(this)">
                                BDD - Mastermind : View preparation to make the UI testable
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/development/bdd/tdd/2014-09-29-bdd-mastermind-tdd-in-the-model.html">
                        
                            <a href="/development/bdd/tdd/2014-09-29-bdd-mastermind-tdd-in-the-model.html" onclick="pageScrollToTop(this)">
                                BDD - Mastermind : TDD in the model
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/development/bdd/2014-09-25-bdd-mastermind-internal-design.html">
                        
                            <a href="/development/bdd/2014-09-25-bdd-mastermind-internal-design.html" onclick="pageScrollToTop(this)">
                                BDD - Mastermind : Internal design
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/development/extra/bdd/2014-08-20-bdd-from-the-idea-to-the-app-2.html">
                        
                            <a href="/development/extra/bdd/2014-08-20-bdd-from-the-idea-to-the-app-2.html" onclick="pageScrollToTop(this)">
                                BDD: From the idea to the App 2
                            </a>
                            
                                
                            
                        </li>
                    
                        
                        <li class="chapter" data-level="1.1" data-path="/productivity/o'reilly/video/2014-07-02-oreilly-media-videos.html">
                        
                            <a href="/productivity/o'reilly/video/2014-07-02-oreilly-media-videos.html" onclick="pageScrollToTop(this)">
                                O&#39;Reilly Media Videos
                            </a>
                            
                                
                            
                        </li>
                    

                    
                        <li class="divider"></li>
                    
                
            
        </ul>
    </nav>
</div>
<div class="book-body">
                <div class="book-header" role="navigation">
                    <!-- Title -->
                    <h1>
                        <i class="fa fa-circle-o-notch fa-spin"></i>
                        
                            <a href="." >BDD - Mastermind : View preparation</a>
                        
                    </h1>
                </div>

                <div class="body-inner"><div class="page-wrapper" tabindex="-1" role="main">
    

    <div class="page-inner">
        <div id="book-search-results">
            <div class="search-noresults">
                <section class="normal markdown-section">
                    
                        <h1 id="/development/bdd/tdd/bdd-mastermind-view-preparation">BDD - Mastermind : View preparation</h1>
                    

                    <p>This is the fifth post to create an application using BDD and TDD in iOS. If you missed the previous post, my recommendation is that you read it first <a href="/blog/2014/10/21/bdd-mastermind-view-preparation-to-make-the-ui-testable/" title="BDD - Mastermind : View preparation to make the UI testable">here</a>.</p>

<p>In the previous post I went through a way to test the visible result of the custom view in a very intuitive way. It was just an exercise to test how, in a simple way, we could have a complete test of how we expect our view looks like. The truth is that this is a feeble method as it depends on an image that might or might not be 100% achievable by the tools we can make use of.</p>

<p>The purpose of the previous post was to introduce the technique we are going to use in this post. We are going to go through a technique that allows us to test the final behavior in a more secure and maintainable way.</p>

<p>You can find the code corresponding to this post in <a href="https://github.com/guillemf/Mastermind-BDD/tree/Step_6" title="MasterMind-BDD Step6">this commit</a>. Go and get it!
<!-- more --></p>
<h1 id="the-result-cells">The result cells</h1>

<p><img class="left" src="https://farm3.staticflickr.com/2941/15101651020_46fb32d967_o.jpg" width="190" height="490" title="Mastermind Sketch With zones" alt="Mastermind board Sketch with zones" /></p>

<p>The second element we have on the screen is the results cell. If you remember from the first post of the series, we defined three areas to consider. Area number three is a special kind of view that provides different visual aspects depending on the result we are providing. The rules are described in the second post of the series <a href="/blog/2014/09/25/bdd-mastermind-internal-design/" title="BDD - Mastermind : Internal design">BDD - Mastermind : Internal design</a>, but we need add a few more “conditions” to have a really robust view that does what we want it to do.</p>

<p><strong>First</strong> - We are only accepting two different symbols, no matter which symbols but just two different.<br />
<strong>Second</strong> - If the first symbol is a space, then it is considered there are no symbols of the first type and all the symbols are considered second kind.<br />
<strong>Third</strong> - As there is no specification, the circles will try to fill as much space as possible. One symbol will end in a single big circle.</p>

<p>With this in mind we have enough information to start creating the tests to implement the result cell.</p>

<h1 id="test-and-implementation">Test and implementation</h1>

<p>A very common practice is to create helper methods to simplify the test and provide more clarity. In this case we need to create a combination generator, so I implement this random combination generators.</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">// Helper Methods</span>
<span class="k">-</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">generateRandomCharString</span>
<span class="p">{</span>
    <span class="c1">// Available symbols</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">symbols</span> <span class="o">=</span> <span class="s">@"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span><span class="p">;</span>
    
    <span class="c1">// Pick a random index to extract two symbols</span>
    <span class="kt">int</span> <span class="n">symbolIndex</span> <span class="o">=</span> <span class="n">arc4random_uniform</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">symbols</span><span class="p">.</span><span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Obtain the two random symbols</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">symbol</span> <span class="o">=</span> <span class="p">[</span><span class="n">symbols</span> <span class="nf">substringWithRange</span><span class="p">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="n">symbolIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">)];</span>
    
    <span class="c1">// Obtain random number of each symbols</span>
    <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">arc4random_uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
    
    <span class="n">NSMutableString</span> <span class="o">*</span><span class="n">resultString</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableString</span> <span class="nf">stringWithString</span><span class="p">:</span><span class="s">@""</span><span class="p">];</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">n</span><span class="o">&lt;</span><span class="n">length</span><span class="p">;</span> <span class="n">n</span><span class="o">++</span><span class="p">)</span>
        <span class="p">[</span><span class="n">resultString</span> <span class="nf">appendString</span><span class="p">:</span><span class="n">symbol</span><span class="p">];</span>
    
    <span class="k">return</span> <span class="p">[</span><span class="n">resultString</span> <span class="nf">copy</span><span class="p">];</span>
    
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">generateRandomResult</span>
<span class="p">{</span>
    <span class="n">NSMutableString</span> <span class="o">*</span><span class="n">resultString</span> <span class="o">=</span> <span class="p">[[</span><span class="n">self</span> <span class="nf">generateRandomCharString</span><span class="p">]</span> <span class="nf">mutableCopy</span><span class="p">];</span>
    <span class="k">return</span> <span class="p">[[</span><span class="n">resultString</span> <span class="nf">stringByAppendingString</span><span class="p">:[</span><span class="n">self</span> <span class="nf">generateRandomCharString</span><span class="p">]]</span> <span class="nf">copy</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="n">NSData</span> <span class="o">*</span><span class="p">)</span><span class="nf">dataForCellPNGRepresentationForView</span><span class="p">:(</span><span class="n">UIView</span> <span class="o">*</span><span class="p">)</span><span class="nv">view</span>
<span class="p">{</span>
    <span class="n">UIGraphicsBeginImageContext</span><span class="p">(</span><span class="n">view</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">);</span>
    <span class="p">[</span><span class="n">view</span><span class="p">.</span><span class="n">layer</span> <span class="nf">renderInContext</span><span class="p">:</span><span class="n">UIGraphicsGetCurrentContext</span><span class="p">()];</span>
    <span class="n">UIImage</span><span class="o">*</span> <span class="n">image1</span> <span class="o">=</span> <span class="n">UIGraphicsGetImageFromCurrentImageContext</span><span class="p">();</span>
    <span class="n">UIGraphicsEndImageContext</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">UIImagePNGRepresentation</span><span class="p">(</span><span class="n">image1</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<ul>
  <li><strong>generateRandomCharString</strong> - Is used to generate a string of random lenght of a random symbol. As you can see I previously have defined the array of valid symbols which contain no space. A good practice would be to add a test to check that any symbol placed is included in the set of valid symbols.</li>
  <li><strong>generateRandomResult</strong> - Is the method used to create a combination of two symbols.</li>
  <li><strong>dataForCellPNGRepresentationForView</strong> - Is the method used to obtain a png representation of the view. That is the way we can compare two views at visual level.</li>
</ul>

<p>Now that we have all we need, let’s write some tests. I won’t go though each test as they are trivial, just list them.</p>

<ul>
  <li>Test that on init the background is transparent.</li>
  <li>Test that on init the combination value is empty.</li>
  <li>Test that when the combination changes bezier path changes.</li>
  <li>Test that when the combination is empty bezier paths contains zero circles.</li>
  <li>Test that when the combination changes bezier paths contains the same number of circles as the length of the combination.</li>
  <li>Test that when the combination has more than two different symbols only first two are stored.</li>
  <li>Test that when the combination changes bezier paths contains only bezier paths;</li>
</ul>

<h1 id="the-final-method-for-testing-the-visual-result">The final method for testing the visual result</h1>

<p>As I commented before, testing against images has some important limitations like depending on the device implementation, small changes makes the test fail, etc … So, which is the best way to do it? Well nothing better than comparing a view with another view. That way we can be sure there is no difference and we can update easily the implementation.</p>

<p>To do it, you just need to create a view that looks like what you expect your view to look like.</p>

<p>You might think, that is duplicating the effort.</p>

<p>Well, create a dummy view that just does one thing is not duplicating the effort, is prototyping what you expect to obtain and also lets you define some rules that you might translate to your view.</p>

<p>Let’s take a look at the dummy view I’ve implemented and you’ll understand better what I mean.</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">// Dummy view to draw the image we expect</span>

<span class="k">@interface</span> <span class="nc">DummyView</span> <span class="p">:</span> <span class="nc">UIView</span>

<span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span> <span class="n">strong</span><span class="p">)</span> <span class="n">NSString</span> <span class="o">*</span><span class="n">combination</span><span class="p">;</span>
<span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span> <span class="n">strong</span><span class="p">)</span> <span class="n">UIColor</span> <span class="o">*</span><span class="n">color</span><span class="p">;</span>

<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">DummyView</span>

<span class="k">-</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="nf">initWithFrame</span><span class="p">:(</span><span class="n">CGRect</span><span class="p">)</span><span class="nv">frame</span> <span class="nf">combination</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">combination</span> <span class="nf">color</span><span class="p">:(</span><span class="n">UIColor</span> <span class="o">*</span><span class="p">)</span><span class="nv">color</span>
<span class="p">{</span>
    <span class="n">self</span> <span class="o">=</span> <span class="p">[</span><span class="n">super</span> <span class="nf">initWithFrame</span><span class="p">:</span><span class="n">frame</span><span class="p">];</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">self</span><span class="p">.</span><span class="n">combination</span> <span class="o">=</span> <span class="n">combination</span><span class="p">;</span>
        <span class="n">self</span><span class="p">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">;</span>
        <span class="n">self</span><span class="p">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIColor</span> <span class="nf">clearColor</span><span class="p">];</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">self</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">drawRect</span><span class="p">:(</span><span class="n">CGRect</span><span class="p">)</span><span class="nv">rect</span> <span class="p">{</span>
    <span class="c1">// Obtain first char</span>
    <span class="n">unichar</span> <span class="n">leftchar</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">combination</span> <span class="nf">characterAtIndex</span><span class="p">:</span><span class="mi">0</span><span class="p">];</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">combination</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">combination</span> <span class="nf">stringByReplacingOccurrencesOfString</span><span class="p">:</span><span class="s">@" "</span> <span class="nf">withString</span><span class="p">:</span><span class="s">@""</span><span class="p">];</span>
    <span class="c1">// Obtain rectangle ration</span>
    <span class="kt">float</span> <span class="n">K</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="o">/</span><span class="n">rect</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">;</span>
    <span class="c1">// Obtain number of items</span>
    <span class="kt">long</span> <span class="n">N</span> <span class="o">=</span> <span class="n">combination</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>
    
    <span class="c1">// Obtain grid sizes</span>
    <span class="kt">float</span> <span class="n">verItems</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">sqrtf</span><span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">N</span><span class="p">));</span>
    <span class="kt">float</span> <span class="n">horItems</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">sqrtf</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">K</span><span class="p">));</span>
    
    <span class="c1">// Items horizontally</span>
    <span class="kt">float</span> <span class="n">gridHeigh</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span> <span class="o">/</span> <span class="n">verItems</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">gridWidth</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span> <span class="o">/</span> <span class="n">horItems</span><span class="p">;</span>
    
    <span class="c1">// Draw circles</span>
    <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">color</span> <span class="nf">setFill</span><span class="p">];</span>
    <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">color</span> <span class="nf">setStroke</span><span class="p">];</span>
    
    <span class="n">UIBezierPath</span> <span class="o">*</span><span class="n">bezPath</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">currentElement</span><span class="p">;</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">verItems</span><span class="p">;</span> <span class="n">y</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">horItems</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">currentElement</span> <span class="o">=</span> <span class="p">(</span><span class="n">horItems</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="n">x</span> <span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">currentElement</span> <span class="o">&gt;=</span> <span class="n">N</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">bezPath</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIBezierPath</span> <span class="nf">bezierPathWithOvalInRect</span><span class="p">:</span><span class="n">CGRectMake</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">gridWidth</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="n">gridHeigh</span><span class="p">,</span> <span class="n">gridWidth</span><span class="p">,</span> <span class="n">gridHeigh</span><span class="p">)];</span>
            <span class="k">if</span> <span class="p">([</span><span class="n">combination</span> <span class="nf">characterAtIndex</span><span class="p">:</span><span class="n">currentElement</span><span class="p">]</span> <span class="o">==</span> <span class="n">leftchar</span><span class="p">)</span> <span class="p">{</span>
                <span class="p">[</span><span class="n">bezPath</span> <span class="nf">fill</span><span class="p">];</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="p">[</span><span class="n">bezPath</span> <span class="nf">stroke</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="k">@end</span></code></pre></figure>

<p>This is the final implementation of the view, but usually it will grow with your development. Adding new features that you expect to find in your view. And more important, will protect you from changing what you expect to see if you make any change in your code in the future.</p>

<p>With that in mind, the tests become a lot more clear.</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">testIfNewResultHasOnlyOneSymbolByDefaultAreFirstSymbol</span>
<span class="p">{</span>
    <span class="n">resultCell</span><span class="p">.</span><span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span> <span class="nf">generateRandomCharString</span><span class="p">];</span>
    <span class="n">resultCell</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">arc4random_uniform</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span> <span class="n">arc4random_uniform</span><span class="p">(</span><span class="mi">300</span><span class="p">));</span>
    
    <span class="n">DummyView</span> <span class="o">*</span><span class="n">dummyV</span> <span class="o">=</span> <span class="p">[[</span><span class="n">DummyView</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithFrame</span><span class="p">:</span><span class="n">resultCell</span><span class="p">.</span><span class="n">frame</span>
                                             <span class="nl">combination:</span><span class="n">resultCell</span><span class="p">.</span><span class="n">result</span>
                                                   <span class="nl">color:</span><span class="n">resultCell</span><span class="p">.</span><span class="n">color</span><span class="p">];</span>
    
    <span class="n">NSData</span> <span class="o">*</span><span class="n">expectedImage</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span> <span class="nf">dataForCellPNGRepresentationForView</span><span class="p">:</span><span class="n">dummyV</span><span class="p">];</span>
    
    <span class="n">NSData</span> <span class="o">*</span><span class="n">obtainedImage</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span> <span class="nf">dataForCellPNGRepresentationForView</span><span class="p">:</span><span class="n">resultCell</span><span class="p">];</span>
    
    
    <span class="n">XCTAssertEqualObjects</span><span class="p">(</span><span class="n">expectedImage</span><span class="p">,</span> <span class="n">obtainedImage</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<ol>
  <li>Create our view.</li>
  <li>Create a dummy view with the same parameters.</li>
  <li>Extract the representing images.</li>
  <li>Check both match.</li>
</ol>

<p>Take a look at the rest of the test, I think they are pretty clear, but if you believe there is something you can’t see, just send me an email or leave me a comment.</p>

<p>And with this post I finish with the TDD by now and we can start with the BDD.</p>

<p>Please, leave me comments, share and like if you can! See you in the next post.</p>
</section>
            </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div></div>
    </div>
</div>

<!-- introduce mathjax support -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [ ['$', '$'], ['\\(', '\\)'] ]
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script
  type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>


<!-- introduce per-page mermaid support -->


<!-- introduce mathjax support -->
<script>
    function fixes_chrome_anchors() {
        let chrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
        if (window.location.hash && chrome) {
            setTimeout(function () {
                var hash = window.location.hash;
                window.location.hash = "";
                window.location.hash = hash;
            }, 300);
        }
    }

    if (document.readyState === "loading") {
        // Loading hasn't finished yet
        document.addEventListener("DOMContentLoaded", fixes_chrome_anchors);
    } else {
        // `DOMContentLoaded` has already fired
        fixes_chrome_anchors();
    }
</script>


                        <a href="/development/bdd/tdd/2014-10-21-bdd-mastermind-view-preparation-to-make-the-ui-testable.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: BDD - Mastermind : View preparation to make the UI testable">
                            <i class="fa fa-angle-left"></i>
                        </a>
                    

                    
                        <a href="/development/bdd/tdd/2014-11-20-bdd-mastermind-adding-calabash-and-creating-our-first-tests.html" class="navigation navigation-next navigation-unique" aria-label="Next page: BDD - Mastermind : Adding calabash and creating our first tests">
                            <i class="fa fa-angle-right"></i>
                        </a>
                    
                </div>
            </div>

            <script>
            var gitbook = gitbook || [];
            gitbook.push(function() {
                gitbook.page.hasChanged({
    "page": {
        "title": "Introduction",
        "level": "1.1",
        "depth": 1,
        
        "next": {
            "title": "BDD - Mastermind : Adding calabash and creating our first tests",
            "level": "1.2",
            "depth": 1,
            "path": "_posts/2014-11-20-bdd-mastermind-adding-calabash-and-creating-our-first-tests.markdown",
            "ref": "_posts/2014-11-20-bdd-mastermind-adding-calabash-and-creating-our-first-tests.markdown",
            "articles": []
        },
        
        "dir": "ltr"
    },    "config": {
        "plugins": ["fontsettings", "highlight", "livereload", "lunr", "search", "sharing", "theme-default", "livereload"],
        "styles": {
            "ebook": "styles/ebook.css",
            "epub": "styles/epub.css",
            "mobi": "styles/mobi.css",
            "pdf": "styles/pdf.css",
            "print": "styles/print.css",
            "website": "styles/website.css"
        },
        "pluginsConfig": {
            "expandable-chapter-small2": {
                "articlesExpand": true,
            },
            "fontsettings": {
                "family": "sans",
                "size": 2,
                "theme": "white"
            },
            "highlight": {},
            "livereload": {},
            "lunr": {
                "ignoreSpecialCharacters": false,
                "maxIndexSize": 1000000
            },
            "search": {},            "sharing": {
                "facebook": true,

                "google": false,

                "github": true,
              
                "github_link": "https://github.com/guillemf",
              

                "telegram": false,
                "telegram_link": "https://t.me",

                "instapaper": false,

                "twitter": true,
              
                "twitter_link": "https://twitter.com/guillemfg",
              

                "vk": false,

                "weibo": false,

                "all": ["facebook", "google", "twitter", "weibo", "instapaper", "github", "telegram"]
            },
"theme-default": {
                "showLevel": false,
                "styles": {
                    "ebook": "styles/ebook.css",
                    "epub": "styles/epub.css",
                    "mobi": "styles/mobi.css",
                    "pdf": "styles/pdf.css",
                    "print": "styles/print.css",
                    "website": "styles/website.css"
                }
            },
        },
        "theme": "default",
        "author": "Tao He",
        "pdf": {
            "pageNumbers": true,
            "fontSize": 12,
            "fontFamily": "Arial",
            "paperSize": "a4",
            "chapterMark": "pagebreak",
            "pageBreaksBefore": "/",
            "margin": {
                "right": 62,
                "left": 62,
                "top": 56,
                "bottom": 56
            }
        },
        "structure": {
            "langs": "LANGS.md",
            "readme": "README.md",
        },
        "variables": {},
        "title": "Guillem Efege",
        "language": "en",
        "gitbook": "*"
    },
    "file": {
        "path": "_posts/2014-11-10-bdd-mastermind-view-preparation.markdown",
        "mtime": "2014-11-10 13:25:00 +0100",
        "type": "markdown"
    },
    "gitbook": {
        "version": "3.2.3",
        "time": "2024-06-10 18:01:45 +0200"
    },
    "basePath": "",
    "book": {
        "language": ""
    }
});
            });
            </script>
        </div><script src="/assets/gitbook/gitbook.js"></script>
<script src="/assets/gitbook/theme.js"></script>

<script src="/assets/gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
<script src="/assets/gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
<script src="/assets/gitbook/gitbook-plugin-expandable-chapters-small2/expandable-chapters-small.js"></script>
<script src="/assets/gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
<script src="/assets/gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
<script src="/assets/gitbook/gitbook-plugin-search-pro/search.js"></script>
<script src="/assets/gitbook/gitbook-plugin-sharing/buttons.js"></script>
<script src="/assets/gitbook/gitbook-plugin-splitter/splitter.js"></script>

<!--
<script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
<script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
<script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
<script src="../gitbook/gitbook-plugin-search/search.js"></script>
-->

</body>
</html>